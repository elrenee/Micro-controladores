/*Lab05, Micros * Created:29/03/2025  * Author: René David González * Description: Laboratorio 05, programación de microcontroladores. Convertidor de señales analogas y digitales, Señales PWM  *//****************************************/// Encabezado (Libraries)#define F_CPU 16000000#include <avr/io.h>#include <avr/interrupt.h>#include "PWM0/PWM.h"#include "PWM2/PWM2.h"#include "PWMmanual/manual.h"uint8_t duty2=0;uint8_t adctoduty=0;uint16_t conversion1=0;uint8_t conversion2=0;uint8_t conversion3=0;	uint8_t contador=0;uint8_t contadorpwm=0;/****************************************/// Function prototypesvoid setup();void initadc();/****************************************/// Main Functionint main(void){	setup();	while (1)	{		funciondutycycle(adctoduty);		//funciondutycycle2(duty2);	}}/****************************************/// NON-Interrupt subroutines	void setup(){	cli();	DDRB|= (1<<DDB0); //PB0 como salida	DDRC=0;	PORTC=0; //Puerto c como entrada, estaran los ADC´s	initPWM();	//initpwm2();	initadc();	initTMR();	ADCSRA |= (1<<ADSC);	sei();}void initadc(){	ADMUX=0;	ADMUX |= (1<< REFS0) | (1<<ADLAR) | (1<<MUX2) | (1<<MUX1);//Referencia de 5v, Ajustado a la izq, Canal 6 de ADC	ADCSRA= 0;	ADCSRA |= (1<<ADPS2)| (1<< ADPS1)|(1<< ADPS0)|(1<< ADIE)| (1<< ADEN);//Prescalers, Interrupciónes habilitadas, ADC Enable.	//ADCSRB =0; //Modo free running.}/**************************************/// Interrupt routinesISR(ADC_vect){	contador++;	if (contador==1)	{		conversion1= ADCH;		ADMUX &= ~((1<<MUX2)|(1<<MUX1));		adctoduty=1200+(conversion1*3.52);		ADCSRA |=(1<<ADSC);	}	else if (contador==2)	{		conversion2= ADCH;		ADMUX |= (1<<MUX0);		ADCSRA|=(1<<ADSC);	}	else if (contador==3)	{		conversion3 =ADCH;		ADMUX &= ~(1<<MUX0);		ADMUX |= (1<<MUX2) | (1<<MUX1);		ADCSRA |= (1<<ADSC);		contador=0;	}}ISR(TIMER0_OVF_vect){	contadorpwm++;	if (contadorpwm<conversion3)	{		PORTB|= (1<<PORTB0);	}	else if (contadorpwm>conversion3)	{		PORTB &= ~(1<<PORTB0);	}}